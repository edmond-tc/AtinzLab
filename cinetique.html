<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SimuKin â€” CinÃ©tique Chimique | Edmond Atinzoun TCHOKPON</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@400;500&family=Nunito:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#07080f;
  --surface:#0d0f1c;
  --surface2:#12152a;
  --surface3:#181c35;
  --p1:#ff6b35;   /* orange â€” cinÃ©tique */
  --p2:#00d4aa;   /* teal */
  --p3:#a78bfa;   /* violet */
  --p4:#fbbf24;   /* gold */
  --p5:#38bdf8;   /* sky */
  --danger:#f43f5e;
  --text:#e8eaf6;
  --muted:#4a5080;
  --border:#1e2245;
  --c0:#ff6b35;
  --c1:#00d4aa;
  --c2:#a78bfa;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:'Nunito',sans-serif;min-height:100vh;overflow-x:hidden;}

/* NOISE OVERLAY */
body::before{
  content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
  opacity:.4;
}

/* HEADER */
header{
  position:relative;z-index:10;
  background:linear-gradient(135deg,#07080f 0%,#0d0f1c 100%);
  border-bottom:1px solid var(--border);
  padding:14px 28px;display:flex;align-items:center;justify-content:space-between;
  box-shadow:0 0 40px rgba(255,107,53,0.08);
}
.logo{display:flex;align-items:center;gap:14px;}
.logo-gem{
  width:48px;height:48px;
  background:linear-gradient(135deg,var(--p1),#ff9500);
  clip-path:polygon(50% 0%,100% 25%,100% 75%,50% 100%,0% 75%,0% 25%);
  display:flex;align-items:center;justify-content:center;
  font-size:20px;box-shadow:0 0 24px rgba(255,107,53,0.5);
  animation:gemPulse 3s ease-in-out infinite;
}
@keyframes gemPulse{0%,100%{box-shadow:0 0 24px rgba(255,107,53,0.5)}50%{box-shadow:0 0 40px rgba(255,107,53,0.8)}}
.logo-text h1{font-family:'Syne',sans-serif;font-size:1.6rem;font-weight:800;color:var(--p1);letter-spacing:3px;text-shadow:0 0 30px rgba(255,107,53,0.4);}
.logo-text p{font-size:0.68rem;color:var(--muted);letter-spacing:2px;font-family:'JetBrains Mono',monospace;}
.header-right{display:flex;align-items:center;gap:12px;}
.author-tag{
  background:var(--surface2);border:1px solid var(--p1);
  border-radius:8px;padding:8px 16px;text-align:right;
  box-shadow:0 0 16px rgba(255,107,53,0.1);
}
.author-tag .n{font-family:'Syne',sans-serif;font-size:0.92rem;font-weight:700;color:var(--p1);}
.author-tag .i{font-size:0.62rem;color:var(--muted);font-family:'JetBrains Mono',monospace;}
.lang-btn{
  background:var(--surface2);border:1px solid var(--border);
  color:var(--text);border-radius:6px;padding:7px 16px;cursor:pointer;
  font-family:'Syne',sans-serif;font-weight:600;font-size:0.82rem;letter-spacing:1px;
  transition:all .2s;
}
.lang-btn:hover{border-color:var(--p1);color:var(--p1);}

/* TABS */
.tabs{
  position:relative;z-index:5;
  background:var(--surface);border-bottom:1px solid var(--border);
  padding:10px 28px;display:flex;gap:6px;overflow-x:auto;
}
.tab{
  padding:8px 18px;border-radius:8px;border:1px solid var(--border);
  background:transparent;color:var(--muted);cursor:pointer;
  font-family:'Syne',sans-serif;font-weight:600;font-size:0.82rem;letter-spacing:1px;
  transition:all .25s;white-space:nowrap;
}
.tab.active{background:linear-gradient(135deg,rgba(255,107,53,.18),rgba(255,149,0,.08));border-color:var(--p1);color:var(--p1);box-shadow:0 0 18px rgba(255,107,53,.2);}
.tab:hover:not(.active){border-color:var(--muted);color:var(--text);}

/* APP LAYOUT */
.app{display:none;padding:20px 28px;gap:18px;flex-wrap:wrap;position:relative;z-index:1;min-height:calc(100vh - 130px);}
.app.active{display:flex;}

/* PANEL */
.panel{
  background:var(--surface);border:1px solid var(--border);
  border-radius:14px;padding:18px;position:relative;overflow:hidden;
}
.panel::after{
  content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,transparent,var(--p1),transparent);opacity:.6;
}
.ptitle{
  font-family:'Syne',sans-serif;font-weight:700;font-size:.78rem;
  letter-spacing:2px;color:var(--p1);text-transform:uppercase;
  margin-bottom:14px;display:flex;align-items:center;gap:8px;
}

/* FORM */
.fg{margin-bottom:12px;}
.fg label{display:block;font-size:.7rem;color:var(--muted);letter-spacing:1px;margin-bottom:4px;font-family:'JetBrains Mono',monospace;}
.fg select,.fg input[type=number],.fg input[type=range]{
  width:100%;background:var(--surface2);border:1px solid var(--border);
  color:var(--text);border-radius:6px;padding:8px 10px;
  font-family:'Nunito',sans-serif;font-size:.84rem;outline:none;transition:border-color .2s;
}
.fg select:focus,.fg input:focus{border-color:var(--p1);box-shadow:0 0 10px rgba(255,107,53,.12);}
.fg input[type=range]{padding:4px 0;accent-color:var(--p1);}

/* BUTTONS */
.btn{width:100%;padding:10px;border-radius:8px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-weight:700;font-size:.92rem;letter-spacing:2px;transition:all .25s;margin-top:5px;}
.btn-p{background:linear-gradient(135deg,var(--p1),#ff9500);color:#000;box-shadow:0 0 22px rgba(255,107,53,.3);}
.btn-p:hover{transform:translateY(-1px);box-shadow:0 4px 28px rgba(255,107,53,.5);}
.btn-s{background:linear-gradient(135deg,var(--p2),#00a88a);color:#000;}
.btn-s:hover{transform:translateY(-1px);}
.btn-d{background:transparent;color:var(--danger);border:1px solid var(--danger);}
.btn-d:hover{background:var(--danger);color:#fff;}
.btn-sm{width:auto;padding:7px 14px;font-size:.76rem;margin:0;}

/* INSTRUMENTS */
.instruments{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:12px;}
.instr{
  background:var(--surface2);border:1px solid var(--border);
  border-radius:10px;padding:10px 14px;text-align:center;min-width:78px;
}
.instr .val{font-family:'JetBrains Mono',monospace;font-size:1.25rem;font-weight:500;color:var(--p2);text-shadow:0 0 10px rgba(0,212,170,.5);}
.instr .unit{font-size:.6rem;color:var(--muted);margin-top:2px;}
.instr .lbl{font-size:.6rem;color:var(--muted);letter-spacing:1px;}

/* DATA TABLE */
.dtable{width:100%;border-collapse:collapse;font-size:.76rem;font-family:'JetBrains Mono',monospace;}
.dtable th{background:rgba(255,107,53,.1);color:var(--p1);padding:6px 8px;text-align:center;border-bottom:1px solid var(--border);font-size:.68rem;letter-spacing:1px;}
.dtable td{padding:5px 8px;text-align:center;border-bottom:1px solid rgba(30,34,69,.5);color:var(--text);}
.dtable tr:hover td{background:rgba(255,107,53,.04);}

/* STATUS */
.statusbar{
  position:relative;z-index:5;background:var(--surface);
  border-top:1px solid var(--border);padding:8px 28px;
  display:flex;align-items:center;gap:20px;
  font-family:'JetBrains Mono',monospace;font-size:.7rem;color:var(--muted);flex-wrap:wrap;
}
.sindic{display:flex;align-items:center;gap:6px;}
.sdot{width:7px;height:7px;border-radius:50%;background:var(--p2);box-shadow:0 0 6px var(--p2);animation:blink 1.5s infinite;}
.sdot.orange{background:var(--p1);box-shadow:0 0 6px var(--p1);}
.sdot.red{background:var(--danger);box-shadow:0 0 6px var(--danger);}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

/* MOLECULE ANIMATION */
.mol-canvas{border-radius:8px;background:var(--surface2);border:1px solid var(--border);}

/* REACTION DISPLAY */
.rxn-box{
  background:var(--surface2);border:1px solid var(--border);
  border-radius:8px;padding:12px 16px;
  font-family:'JetBrains Mono',monospace;font-size:.9rem;
  text-align:center;color:var(--p2);margin-bottom:12px;
  letter-spacing:1px;
}
.rxn-box .arrow{color:var(--p1);}

/* ENERGY DIAGRAM */
.energy-svg{width:100%;height:180px;}

/* MECHANISM */
.mech-step{
  background:var(--surface2);border:1px solid var(--border);
  border-radius:8px;padding:12px 16px;margin-bottom:8px;
  display:flex;align-items:flex-start;gap:12px;
}
.mech-num{
  width:28px;height:28px;border-radius:50%;
  background:var(--p1);color:#000;font-family:'Syne',sans-serif;
  font-weight:700;font-size:.82rem;display:flex;align-items:center;justify-content:center;
  flex-shrink:0;
}
.mech-text{font-size:.82rem;color:var(--text);line-height:1.6;}
.mech-text .eq{color:var(--p2);font-family:'JetBrains Mono',monospace;font-size:.78rem;}

/* THEORY CARDS */
.thy-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;}
.thy-card{background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:16px;}
.thy-card h3{font-family:'Syne',sans-serif;font-weight:700;color:var(--p1);margin-bottom:10px;font-size:.95rem;letter-spacing:1px;}
.thy-card p,.thy-card li{font-size:.81rem;color:#8a9cc0;line-height:1.65;}
.thy-card ul{padding-left:16px;}
.formula{background:#05060e;border:1px solid var(--border);border-radius:6px;padding:10px;margin:8px 0;font-family:'JetBrains Mono',monospace;color:var(--p4);font-size:.82rem;text-align:center;}
.lvl-badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.62rem;font-weight:700;letter-spacing:1px;margin-bottom:8px;font-family:'JetBrains Mono',monospace;}
.lv-g{background:rgba(0,212,170,.15);color:var(--p2);border:1px solid var(--p2);}
.lv-o{background:rgba(255,107,53,.15);color:var(--p1);border:1px solid var(--p1);}
.lv-v{background:rgba(167,139,250,.15);color:var(--p3);border:1px solid var(--p3);}

/* REPORT */
.rpt-box{background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:20px;font-family:'JetBrains Mono',monospace;font-size:.78rem;color:var(--text);line-height:1.9;}
.rpt-sec{margin-bottom:14px;}
.rpt-sec h4{color:var(--p1);font-family:'Syne',sans-serif;font-size:.88rem;letter-spacing:2px;margin-bottom:6px;}
.hl{color:var(--p2);}.hl2{color:var(--p4);}

/* COLORS per order */
.order-0{color:#38bdf8;}
.order-1{color:#00d4aa;}
.order-2{color:#a78bfa;}

canvas{border-radius:6px;}

@media(max-width:768px){
  header{flex-wrap:wrap;gap:10px;}
  .app{padding:12px;}
}
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="logo">
    <div class="logo-gem">âš¡</div>
    <div class="logo-text">
      <h1 id="appTitle">SIMUKIN</h1>
      <p id="appSub">SIMULATEUR DE CINÃ‰TIQUE CHIMIQUE â€” v1.0</p>
    </div>
  </div>
  <div class="header-right">
    <button class="lang-btn" onclick="toggleLang()" id="langBtn">EN</button>
    <div class="author-tag">
      <div class="n">Edmond Atinzoun TCHOKPON</div>
      <div class="i" id="authorInfo">LICENCE PHYSIQUE-CHIMIE | SIMUKIN 2025</div>
    </div>
  </div>
</header>

<!-- TABS -->
<div class="tabs">
  <button class="tab active" onclick="showTab('cinetique')" id="tab-cinetique">âš¡ CINÃ‰TIQUE</button>
  <button class="tab" onclick="showTab('arrhenius')" id="tab-arrhenius">ğŸŒ¡ï¸ ARRHENIUS</button>
  <button class="tab" onclick="showTab('suivi')" id="tab-suivi">ğŸ“¡ SUIVI EXP.</button>
  <button class="tab" onclick="showTab('mecanisme')" id="tab-mecanisme">ğŸ”— MÃ‰CANISME</button>
  <button class="tab" onclick="showTab('theorie')" id="tab-theorie">ğŸ“š THÃ‰ORIE</button>
  <button class="tab" onclick="showTab('rapport')" id="tab-rapport">ğŸ“‹ RAPPORT</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• CINÃ‰TIQUE TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app active" id="app-cinetique">

  <!-- CONFIG -->
  <div class="panel" style="flex:0 0 270px;">
    <div class="ptitle">ğŸ”§ <span id="lbl-config">CONFIGURATION</span></div>

    <div class="fg">
      <label id="lbl-reaction">RÃ‰ACTION</label>
      <select id="rxnType" onchange="updateRxn()">
        <option value="decomp">A â†’ Produits</option>
        <option value="bimol">A + B â†’ Produits</option>
        <option value="reversible">A â‡Œ B</option>
        <option value="consecutif">A â†’ B â†’ C</option>
      </select>
    </div>

    <div class="fg">
      <label id="lbl-order">ORDRE DE RÃ‰ACTION</label>
      <select id="orderSel" onchange="updateOrder()">
        <option value="0">Ordre 0</option>
        <option value="1" selected>Ordre 1</option>
        <option value="2">Ordre 2</option>
      </select>
    </div>

    <div class="fg">
      <label id="lbl-k">CONSTANTE k (sâ»Â¹ ou LÂ·molâ»Â¹Â·sâ»Â¹)</label>
      <input type="number" id="kVal" value="0.05" step="0.005" min="0.001" max="2">
    </div>

    <div class="fg">
      <label id="lbl-c0">CONCENTRATION INITIALE [A]â‚€ (mol/L)</label>
      <input type="number" id="c0Val" value="1.0" step="0.1" min="0.01" max="5">
    </div>

    <div class="fg" id="fg-c0b" style="display:none;">
      <label>[B]â‚€ (mol/L)</label>
      <input type="number" id="c0bVal" value="1.0" step="0.1" min="0.01" max="5">
    </div>

    <div class="fg">
      <label id="lbl-tmax">DURÃ‰E SIMULATION (s)</label>
      <input type="number" id="tmaxVal" value="100" step="10" min="10" max="1000">
    </div>

    <div class="fg">
      <label id="lbl-temp">TEMPÃ‰RATURE (K)</label>
      <input type="range" id="tempVal" min="250" max="450" value="298" oninput="updateTempDisplay(this.value)">
      <div style="text-align:center;font-family:'JetBrains Mono',monospace;font-size:.82rem;color:var(--p1)" id="temp-disp">298 K (25 Â°C)</div>
    </div>

    <button class="btn btn-p" onclick="runKinetics()" id="btn-run">â–¶ SIMULER</button>
    <button class="btn btn-d" onclick="resetKin()" style="margin-top:7px;" id="btn-reset">â†º RÃ‰INITIALISER</button>
    <button class="btn btn-s" onclick="compareOrders()" style="margin-top:7px;" id="btn-compare">âš– COMPARER ORDRES</button>
  </div>

  <!-- LAB VISUAL + INSTRUMENTS -->
  <div class="panel" style="flex:0 0 300px;">
    <div class="ptitle">ğŸ”¬ <span id="lbl-labo">RÃ‰ACTEUR VIRTUEL</span></div>
    <div id="rxn-display" class="rxn-box">A <span class="arrow">â†’</span> Produits</div>

    <!-- Molecular animation canvas -->
    <canvas id="molCanvas" width="260" height="200" class="mol-canvas"></canvas>

    <div class="instruments">
      <div class="instr">
        <div class="val" id="disp-ca">1.000</div>
        <div class="unit">mol/L</div>
        <div class="lbl">[A](t)</div>
      </div>
      <div class="instr">
        <div class="val" id="disp-t">0</div>
        <div class="unit">s</div>
        <div class="lbl">TEMPS</div>
      </div>
      <div class="instr">
        <div class="val" id="disp-t12">â€”</div>
        <div class="unit">s</div>
        <div class="lbl" id="lbl-t12">tÂ½</div>
      </div>
      <div class="instr">
        <div class="val" id="disp-conv">0.0</div>
        <div class="unit">%</div>
        <div class="lbl" id="lbl-conv">CONV.</div>
      </div>
    </div>

    <!-- Progress bar -->
    <div style="margin-top:12px;">
      <div style="font-size:.65rem;color:var(--muted);font-family:'JetBrains Mono',monospace;margin-bottom:4px;" id="lbl-progress">AVANCEMENT DE LA RÃ‰ACTION</div>
      <div style="background:var(--surface2);border-radius:10px;height:12px;overflow:hidden;border:1px solid var(--border);">
        <div id="progress-bar" style="height:100%;width:0%;background:linear-gradient(90deg,var(--p1),var(--p4));border-radius:10px;transition:width .3s;box-shadow:0 0 10px rgba(255,107,53,.5);"></div>
      </div>
    </div>

    <!-- Playback controls -->
    <div style="display:flex;gap:8px;margin-top:12px;justify-content:center;">
      <button class="btn btn-sm" onclick="stepBack()" style="background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:6px;font-family:'Syne',sans-serif;font-weight:600;cursor:pointer;">â® -5s</button>
      <button class="btn btn-sm" id="btn-play" onclick="togglePlay()" style="background:linear-gradient(135deg,var(--p1),#ff9500);color:#000;border:none;border-radius:6px;font-family:'Syne',sans-serif;font-weight:700;cursor:pointer;padding:7px 20px;">â–¶ PLAY</button>
      <button class="btn btn-sm" onclick="stepFwd()" style="background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:6px;font-family:'Syne',sans-serif;font-weight:600;cursor:pointer;">+5s â­</button>
    </div>

    <div style="margin-top:10px;text-align:center;">
      <span id="law-display" style="font-family:'JetBrains Mono',monospace;font-size:.72rem;color:var(--p3);">v = k[A]</span>
    </div>
  </div>

  <!-- CHARTS -->
  <div class="panel" style="flex:1;min-width:280px;">
    <div class="ptitle">ğŸ“ˆ <span id="lbl-curve1">[C] = f(t) â€” Ã‰VOLUTION DES CONCENTRATIONS</span></div>
    <canvas id="kinChart" height="220"></canvas>

    <div class="ptitle" style="margin-top:14px;">ğŸ“Š <span id="lbl-curve2">VITESSE v = f(t)</span></div>
    <canvas id="vChart" height="130"></canvas>

    <div class="ptitle" style="margin-top:14px;">ğŸ” <span id="lbl-curve3">LINÃ‰ARISATION â€” DÃ‰TERMINATION DE L'ORDRE</span></div>
    <canvas id="linChart" height="130"></canvas>
  </div>

  <!-- DATA TABLE -->
  <div class="panel" style="flex:0 0 210px;">
    <div class="ptitle">ğŸ“‹ <span id="lbl-table">TABLEAU</span></div>
    <div style="max-height:400px;overflow-y:auto;">
      <table class="dtable">
        <thead>
          <tr><th id="th-t">t (s)</th><th id="th-ca">[A]</th><th id="th-v">v</th></tr>
        </thead>
        <tbody id="kin-tbody"></tbody>
      </table>
    </div>
    <button class="btn btn-p" style="margin-top:10px;font-size:.75rem;" onclick="exportKinCSV()" id="btn-export">â¬‡ CSV</button>

    <!-- Half-life box -->
    <div style="margin-top:12px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px;">
      <div style="font-size:.62rem;color:var(--muted);font-family:'JetBrains Mono',monospace;margin-bottom:6px;">DEMI-VIE tÂ½</div>
      <div id="t12-formula" style="font-family:'JetBrains Mono',monospace;font-size:.82rem;color:var(--p4);">â€”</div>
      <div id="t12-value" style="font-family:'JetBrains Mono',monospace;font-size:1.3rem;color:var(--p2);margin-top:4px;">â€”</div>
    </div>
  </div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• ARRHENIUS TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app" id="app-arrhenius">
  <div class="panel" style="width:100%">
    <div class="ptitle">ğŸŒ¡ï¸ <span id="lbl-arrh-title">LOI D'ARRHÃ‰NIUS â€” k = AÂ·exp(âˆ’Ea/RT)</span></div>
    <div style="display:flex;flex-wrap:wrap;gap:20px;">

      <div style="flex:0 0 270px;">
        <div class="fg">
          <label>FACTEUR PRÃ‰-EXPONENTIEL A (sâ»Â¹)</label>
          <input type="number" id="arrh-A" value="1e10" step="1e9">
        </div>
        <div class="fg">
          <label>Ã‰NERGIE D'ACTIVATION Ea (kJ/mol)</label>
          <input type="number" id="arrh-Ea" value="50" step="5" min="5" max="300">
        </div>
        <div class="fg">
          <label>PLAGE T (K) â€” MIN</label>
          <input type="number" id="arrh-T1" value="280" step="10">
        </div>
        <div class="fg">
          <label>PLAGE T (K) â€” MAX</label>
          <input type="number" id="arrh-T2" value="400" step="10">
        </div>
        <button class="btn btn-p" onclick="runArrhenius()">â–¶ CALCULER</button>

        <!-- Arrhenius result -->
        <div style="margin-top:14px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:14px;">
          <div style="font-size:.62rem;color:var(--muted);font-family:'JetBrains Mono',monospace;">k Ã€ 298 K</div>
          <div id="arrh-k298" style="font-family:'JetBrains Mono',monospace;font-size:1.4rem;color:var(--p1);text-shadow:0 0 14px rgba(255,107,53,.5);margin-top:4px;">â€”</div>
          <div style="font-size:.62rem;color:var(--muted);margin-top:10px;font-family:'JetBrains Mono',monospace;">k Ã€ 350 K</div>
          <div id="arrh-k350" style="font-family:'JetBrains Mono',monospace;font-size:1.1rem;color:var(--p2);margin-top:2px;">â€”</div>
          <div style="font-size:.62rem;color:var(--muted);margin-top:10px;font-family:'JetBrains Mono',monospace;">FACTEUR ACCÃ‰LÃ‰RATION (298â†’350 K)</div>
          <div id="arrh-factor" style="font-family:'JetBrains Mono',monospace;font-size:1.1rem;color:var(--p4);margin-top:2px;">â€”</div>
        </div>

        <!-- Ea slider -->
        <div class="fg" style="margin-top:14px;">
          <label>RÃ‰GLER Ea INTERACTIVEMENT (kJ/mol)</label>
          <input type="range" id="ea-slider" min="10" max="200" value="50" oninput="updateEaSlider(this.value)" style="accent-color:var(--p1)">
          <div style="text-align:center;font-family:'JetBrains Mono',monospace;font-size:.82rem;color:var(--p1)" id="ea-disp">50 kJ/mol</div>
        </div>
      </div>

      <div style="flex:1;min-width:280px;">
        <!-- Energy diagram -->
        <div class="ptitle">âš¡ PROFIL Ã‰NERGÃ‰TIQUE</div>
        <svg id="energySVG" width="100%" height="200" viewBox="0 0 500 200" style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;margin-bottom:14px;"></svg>

        <div class="ptitle">ğŸ“ˆ k = f(T) ET LINÃ‰ARISATION ln(k) = f(1/T)</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
          <canvas id="arrhChart" height="200"></canvas>
          <canvas id="arrhLinChart" height="200"></canvas>
        </div>
        <div style="margin-top:10px;font-family:'JetBrains Mono',monospace;font-size:.72rem;color:var(--muted);">
          Pente de ln(k) = f(1/T) : <span id="arrh-slope" style="color:var(--p4);">â€”</span>
          &nbsp;â†’ Ea = âˆ’pente Ã— R = <span id="arrh-ea-calc" style="color:var(--p2);">â€”</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUIVI EXP. TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app" id="app-suivi">
  <div class="panel" style="width:100%">
    <div class="ptitle">ğŸ“¡ <span id="lbl-suivi-title">MÃ‰THODES DE SUIVI EXPÃ‰RIMENTAL</span></div>
    <div style="display:flex;flex-wrap:wrap;gap:14px;margin-bottom:14px;">
      <button class="btn btn-sm" onclick="showSuivi('spectro')" id="s-spectro" style="background:rgba(167,139,250,.2);border:1px solid var(--p3);color:var(--p3);border-radius:6px;font-family:'Syne',sans-serif;font-weight:600;cursor:pointer;padding:8px 16px;">ğŸŒˆ SPECTROPHOTOMÃˆTRE</button>
      <button class="btn btn-sm" onclick="showSuivi('conduc')" id="s-conduc" style="background:var(--surface2);border:1px solid var(--border);color:var(--muted);border-radius:6px;font-family:'Syne',sans-serif;font-weight:600;cursor:pointer;padding:8px 16px;">âš¡ CONDUCTIMÃˆTRE</button>
      <button class="btn btn-sm" onclick="showSuivi('pressure')" id="s-pressure" style="background:var(--surface2);border:1px solid var(--border);color:var(--muted);border-radius:6px;font-family:'Syne',sans-serif;font-weight:600;cursor:pointer;padding:8px 16px;">ğŸ’¨ PRESSION (GAZ)</button>
    </div>

    <!-- SPECTRO SUIVI -->
    <div id="suivi-spectro" style="display:flex;flex-wrap:wrap;gap:18px;">
      <div style="flex:0 0 260px;">
        <div class="fg"><label>RÃ‰ACTION SUIVIE</label>
          <select id="suivi-rxn">
            <option value="KMnO4">2KMnOâ‚„ + 5Hâ‚‚Câ‚‚Oâ‚„ + 3Hâ‚‚SOâ‚„ â†’ â€¦ (dÃ©coloration)</option>
            <option value="iodine">Hâ‚‚Oâ‚‚ + 2Iâ» + 2Hâº â†’ Iâ‚‚ + 2Hâ‚‚O (iode)</option>
            <option value="crystal">Violet de cristal + OHâ» â†’ incolore</option>
          </select>
        </div>
        <div class="fg"><label>k APPARENT (sâ»Â¹)</label><input type="number" id="sv-k" value="0.02" step="0.005"></div>
        <div class="fg"><label>[RÃ‰ACTIF]â‚€ (mol/L)</label><input type="number" id="sv-c0" value="0.5" step="0.05"></div>
        <div class="fg"><label>Îµ Â· l (L/mol)</label><input type="number" id="sv-eps" value="5000" step="500"></div>
        <button class="btn btn-p" onclick="runSuiviSpectro()">â–¶ SIMULER SUIVI</button>
        <div style="margin-top:12px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center;">
          <div style="font-size:.6rem;color:var(--muted);font-family:'JetBrains Mono',monospace;">ABSORBANCE A(t)</div>
          <div id="sv-abs" style="font-family:'JetBrains Mono',monospace;font-size:2rem;color:var(--p3);text-shadow:0 0 12px rgba(167,139,250,.5);">â€”</div>
        </div>
      </div>
      <div style="flex:1;min-width:280px;">
        <canvas id="suiviSpectroChart" height="250"></canvas>
        <div style="margin-top:10px;font-family:'JetBrains Mono',monospace;font-size:.72rem;color:var(--muted);">
          A(t) = Aâ‚€Â·e^(âˆ’kÂ·t) &nbsp;â†’ &nbsp; <span id="sv-law" style="color:var(--p3);">ln(A) = ln(Aâ‚€) âˆ’ kÂ·t</span>
        </div>
      </div>
    </div>

    <!-- CONDUCTIMÃ‰TRIE SUIVI -->
    <div id="suivi-conduc" style="display:none;flex-wrap:wrap;gap:18px;">
      <div style="flex:0 0 260px;">
        <div class="fg"><label>RÃ‰ACTION</label>
          <select id="cv-rxn">
            <option value="estherification">EstÃ©rification : AcOH + EtOH â‡Œ ester</option>
            <option value="saponification">Saponification : ester + OHâ» â†’ AcOâ»</option>
          </select>
        </div>
        <div class="fg"><label>k (LÂ·molâ»Â¹Â·sâ»Â¹)</label><input type="number" id="cv-k" value="0.005" step="0.001"></div>
        <div class="fg"><label>Câ‚€ (mol/L)</label><input type="number" id="cv-c0" value="1.0" step="0.1"></div>
        <button class="btn btn-p" onclick="runSuiviConduc()">â–¶ SIMULER</button>
        <div style="margin-top:12px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center;">
          <div style="font-size:.6rem;color:var(--muted);font-family:'JetBrains Mono',monospace;">Ïƒ(t) mS/cm</div>
          <div id="cv-sig" style="font-family:'JetBrains Mono',monospace;font-size:2rem;color:var(--p2);text-shadow:0 0 12px rgba(0,212,170,.5);">â€”</div>
        </div>
      </div>
      <div style="flex:1;min-width:280px;">
        <canvas id="suiviCondChart" height="250"></canvas>
      </div>
    </div>

    <!-- PRESSION SUIVI -->
    <div id="suivi-pressure" style="display:none;flex-wrap:wrap;gap:18px;">
      <div style="flex:0 0 260px;">
        <div class="fg"><label>RÃ‰ACTION GAZ</label>
          <select id="pv-rxn">
            <option value="N2O5">Nâ‚‚Oâ‚… â†’ 2NOâ‚‚ + Â½Oâ‚‚ (ordre 1)</option>
            <option value="decomp_azomethane">CHâ‚ƒN=NCHâ‚ƒ â†’ Câ‚‚Hâ‚† + Nâ‚‚ (ordre 1)</option>
          </select>
        </div>
        <div class="fg"><label>k (sâ»Â¹)</label><input type="number" id="pv-k" value="0.01" step="0.001"></div>
        <div class="fg"><label>Pâ‚€ (atm)</label><input type="number" id="pv-p0" value="0.5" step="0.05"></div>
        <div class="fg"><label>T (K)</label><input type="number" id="pv-T" value="320" step="5"></div>
        <button class="btn btn-p" onclick="runSuiviPression()">â–¶ SIMULER</button>
        <div style="margin-top:12px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center;">
          <div style="font-size:.6rem;color:var(--muted);font-family:'JetBrains Mono',monospace;">PRESSION TOTALE (atm)</div>
          <div id="pv-p" style="font-family:'JetBrains Mono',monospace;font-size:2rem;color:var(--p1);text-shadow:0 0 12px rgba(255,107,53,.5);">â€”</div>
        </div>
      </div>
      <div style="flex:1;min-width:280px;">
        <canvas id="suiviPresChart" height="250"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• MÃ‰CANISME TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app" id="app-mecanisme">
  <div class="panel" style="width:100%">
    <div class="ptitle">ğŸ”— <span id="lbl-mech-title">MÃ‰CANISMES RÃ‰ACTIONNELS</span></div>
    <div style="display:flex;flex-wrap:wrap;gap:14px;margin-bottom:20px;">
      <button onclick="showMech('sn1')" class="mech-btn" style="background:rgba(255,107,53,.15);border:1px solid var(--p1);color:var(--p1);border-radius:6px;padding:8px 16px;cursor:pointer;font-family:'Syne',sans-serif;font-weight:600;font-size:.82rem;">SN1</button>
      <button onclick="showMech('sn2')" class="mech-btn" style="background:var(--surface2);border:1px solid var(--border);color:var(--muted);border-radius:6px;padding:8px 16px;cursor:pointer;font-family:'Syne',sans-serif;font-weight:600;font-size:.82rem;">SN2</button>
      <button onclick="showMech('radical')" class="mech-btn" style="background:var(--surface2);border:1px solid var(--border);color:var(--muted);border-radius:6px;padding:8px 16px;cursor:pointer;font-family:'Syne',sans-serif;font-weight:600;font-size:.82rem;">RADICALAIRE</button>
      <button onclick="showMech('michaelis')" class="mech-btn" style="background:var(--surface2);border:1px solid var(--border);color:var(--muted);border-radius:6px;padding:8px 16px;cursor:pointer;font-family:'Syne',sans-serif;font-weight:600;font-size:.82rem;">MICHAELIS-MENTEN</button>
      <button onclick="showMech('consecutif')" class="mech-btn" style="background:var(--surface2);border:1px solid var(--border);color:var(--muted);border-radius:6px;padding:8px 16px;cursor:pointer;font-family:'Syne',sans-serif;font-weight:600;font-size:.82rem;">CONSÃ‰CUTIF Aâ†’Bâ†’C</button>
    </div>
    <div id="mech-content"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• THÃ‰ORIE TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app" id="app-theorie">
  <div class="panel" style="width:100%">
    <div class="ptitle">ğŸ“š COURS â€” CINÃ‰TIQUE CHIMIQUE</div>
    <div class="thy-grid">

      <div class="thy-card">
        <span class="lvl-badge lv-g">LYCÃ‰E / PRÃ‰PA</span>
        <h3>Vitesse de RÃ©action</h3>
        <p>La vitesse de rÃ©action mesure la variation de concentration en fonction du temps.</p>
        <div class="formula">v = âˆ’(1/a)Â·d[A]/dt = (1/b)Â·d[B]/dt</div>
        <p>Elle dÃ©pend de la concentration des rÃ©actifs, de la tempÃ©rature et de la prÃ©sence d'un catalyseur.</p>
      </div>

      <div class="thy-card">
        <span class="lvl-badge lv-g">LYCÃ‰E / PRÃ‰PA</span>
        <h3>Loi de Vitesse & Ordres</h3>
        <div class="formula">v = k Â· [A]â¿ Â· [B]áµ</div>
        <ul>
          <li><strong class="order-0">Ordre 0 :</strong> [A] = [A]â‚€ âˆ’ kÂ·t</li>
          <li><strong class="order-1">Ordre 1 :</strong> [A] = [A]â‚€Â·e^(âˆ’kÂ·t)</li>
          <li><strong class="order-2">Ordre 2 :</strong> 1/[A] = 1/[A]â‚€ + kÂ·t</li>
        </ul>
        <p style="margin-top:8px;">L'ordre global est n+m. Il est dÃ©terminÃ© expÃ©rimentalement.</p>
      </div>

      <div class="thy-card">
        <span class="lvl-badge lv-g">LYCÃ‰E / PRÃ‰PA</span>
        <h3>Demi-vie tÂ½</h3>
        <p>Temps pour que la concentration soit divisÃ©e par 2.</p>
        <div class="formula">Ord. 0 : tÂ½ = [A]â‚€ / 2k<br>Ord. 1 : tÂ½ = ln(2) / k<br>Ord. 2 : tÂ½ = 1 / (kÂ·[A]â‚€)</div>
        <p>Pour l'ordre 1, tÂ½ est indÃ©pendant de [A]â‚€ â€” propriÃ©tÃ© fondamentale !</p>
      </div>

      <div class="thy-card">
        <span class="lvl-badge lv-o">PRÃ‰PA / LICENCE</span>
        <h3>Loi d'ArrhÃ©nius</h3>
        <div class="formula">k = A Â· exp(âˆ’Ea / RT)</div>
        <p>A : facteur prÃ©exponentiel (frÃ©quence de collisions)<br>Ea : Ã©nergie d'activation (J/mol)<br>R = 8,314 JÂ·molâ»Â¹Â·Kâ»Â¹</p>
        <div class="formula">ln(k) = ln(A) âˆ’ Ea/(RÂ·T)</div>
        <p>La pente de ln(k) = f(1/T) vaut âˆ’Ea/R.</p>
      </div>

      <div class="thy-card">
        <span class="lvl-badge lv-o">PRÃ‰PA / LICENCE</span>
        <h3>MÃ©canismes â€” AEQS</h3>
        <p>Approximation de l'Ã‰tat Quasi-Stationnaire (AEQS) : pour un intermÃ©diaire rÃ©actionnel I :</p>
        <div class="formula">d[I]/dt â‰ˆ 0</div>
        <p>L'Ã©tape cinÃ©tiquement dÃ©terminante (ECD) est l'Ã©tape la plus lente. Elle impose la loi de vitesse globale.</p>
      </div>

      <div class="thy-card">
        <span class="lvl-badge lv-v">LICENCE</span>
        <h3>RÃ©actions ConsÃ©cutives Aâ†’Bâ†’C</h3>
        <div class="formula">d[B]/dt = kâ‚[A] âˆ’ kâ‚‚[B]</div>
        <p>[B] passe par un maximum Ã  :</p>
        <div class="formula">t_max = ln(kâ‚‚/kâ‚) / (kâ‚‚âˆ’kâ‚)</div>
        <p>Si kâ‚‚ â‰« kâ‚ : AEQS sur B â†’ v â‰ˆ kâ‚[A]<br>Si kâ‚ â‰« kâ‚‚ : accumulation de B</p>
      </div>

      <div class="thy-card">
        <span class="lvl-badge lv-v">LICENCE</span>
        <h3>Michaelis-Menten (Enzymatique)</h3>
        <div class="formula">v = vmaxÂ·[S] / (Km + [S])</div>
        <p>vmax : vitesse maximale | Km : constante de Michaelis<br>Ã€ [S] = Km : v = vmax/2</p>
        <p>LinÃ©arisation Lineweaver-Burk :</p>
        <div class="formula">1/v = Km/(vmaxÂ·[S]) + 1/vmax</div>
      </div>

      <div class="thy-card">
        <span class="lvl-badge lv-v">LICENCE</span>
        <h3>DÃ©termination de l'Ordre</h3>
        <p>MÃ©thodes graphiques de linÃ©arisation :</p>
        <ul>
          <li><strong class="order-0">Ordre 0 :</strong> [A] = f(t) linÃ©aire â†’ pente = âˆ’k</li>
          <li><strong class="order-1">Ordre 1 :</strong> ln[A] = f(t) linÃ©aire â†’ pente = âˆ’k</li>
          <li><strong class="order-2">Ordre 2 :</strong> 1/[A] = f(t) linÃ©aire â†’ pente = k</li>
        </ul>
      </div>

    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• RAPPORT TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app" id="app-rapport">
  <div class="panel" style="width:100%">
    <div class="ptitle">ğŸ“‹ RAPPORT DE TP AUTOMATIQUE</div>
    <div class="rpt-box" id="rpt-content">
      <div style="text-align:center;color:var(--muted);padding:40px;">âš¡ Effectuez une simulation cinÃ©tique pour gÃ©nÃ©rer le rapport.</div>
    </div>
    <div style="display:flex;gap:10px;margin-top:12px;">
      <button class="btn btn-p" style="flex:1" onclick="generateReport()">ğŸ“‹ GÃ‰NÃ‰RER RAPPORT</button>
      <button class="btn" style="flex:1;background:rgba(0,212,170,.1);border:1px solid var(--p2);color:var(--p2);border-radius:8px;cursor:pointer;font-family:'Syne',sans-serif;font-weight:700;letter-spacing:2px;" onclick="window.print()">ğŸ–¨ï¸ IMPRIMER</button>
    </div>
  </div>
</div>

<!-- STATUS BAR -->
<div class="statusbar">
  <div class="sindic"><div class="sdot" id="sdot"></div><span id="stext">PrÃªt â€” Configurez la simulation</span></div>
  <span>|</span><span id="slevel">Niveau : Licence</span>
  <span>|</span><span>SimuKin v1.0 â€” Edmond Atinzoun TCHOKPON</span>
  <span style="margin-left:auto" id="sclock"></span>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<script>
// â•â•â•â•â•â•â•â•â•â•â• STATE â•â•â•â•â•â•â•â•â•â•â•
const R_GAS = 8.314;
let lang = 'fr';
let kinState = { times:[], concs:[], vels:[], k:0.05, order:1, c0:1, tmax:100, running:false, playInterval:null, playIndex:0, computed:false };
let charts = {};

// â•â•â•â•â•â•â•â•â•â•â• TRANSLATIONS â•â•â•â•â•â•â•â•â•â•â•
const T = {
  fr:{appTitle:'SIMUKIN',appSub:'SIMULATEUR DE CINÃ‰TIQUE CHIMIQUE â€” v1.0',authorInfo:'LICENCE PHYSIQUE-CHIMIE | SIMUKIN 2025','lbl-config':'CONFIGURATION','lbl-reaction':'RÃ‰ACTION','lbl-order':'ORDRE DE RÃ‰ACTION','lbl-k':'CONSTANTE k','lbl-c0':'[A]â‚€ (mol/L)','lbl-tmax':'DURÃ‰E (s)','lbl-temp':'TEMPÃ‰RATURE (K)','btn-run':'â–¶ SIMULER','btn-reset':'â†º RÃ‰INITIALISER','btn-compare':'âš– COMPARER ORDRES','lbl-labo':'RÃ‰ACTEUR VIRTUEL','lbl-t12':'tÂ½','lbl-conv':'CONV.','lbl-progress':'AVANCEMENT DE LA RÃ‰ACTION','lbl-curve1':'[C] = f(t)','lbl-curve2':'VITESSE v = f(t)','lbl-curve3':'LINÃ‰ARISATION','lbl-table':'TABLEAU','btn-export':'â¬‡ CSV','lbl-arrh-title':'LOI D\'ARRHÃ‰NIUS','lbl-suivi-title':'MÃ‰THODES DE SUIVI','lbl-mech-title':'MÃ‰CANISMES RÃ‰ACTIONNELS','stext-ready':'PrÃªt â€” Configurez la simulation',langBtn:'EN'},
  en:{appTitle:'SIMUKIN',appSub:'CHEMICAL KINETICS SIMULATOR â€” v1.0',authorInfo:'DEGREE PHYSICS-CHEMISTRY | SIMUKIN 2025','lbl-config':'CONFIGURATION','lbl-reaction':'REACTION','lbl-order':'REACTION ORDER','lbl-k':'RATE CONSTANT k','lbl-c0':'[A]â‚€ (mol/L)','lbl-tmax':'DURATION (s)','lbl-temp':'TEMPERATURE (K)','btn-run':'â–¶ SIMULATE','btn-reset':'â†º RESET','btn-compare':'âš– COMPARE ORDERS','lbl-labo':'VIRTUAL REACTOR','lbl-t12':'tÂ½','lbl-conv':'CONV.','lbl-progress':'REACTION PROGRESS','lbl-curve1':'[C] = f(t)','lbl-curve2':'RATE v = f(t)','lbl-curve3':'LINEARIZATION','lbl-table':'DATA TABLE','btn-export':'â¬‡ CSV','lbl-arrh-title':'ARRHENIUS LAW','lbl-suivi-title':'MONITORING METHODS','lbl-mech-title':'REACTION MECHANISMS','stext-ready':'Ready â€” Configure simulation',langBtn:'FR'}
};
function toggleLang(){
  lang = lang==='fr'?'en':'fr';
  const t=T[lang];
  for(const[id,val] of Object.entries(t)){const el=document.getElementById(id);if(el)el.textContent=val;}
  document.getElementById('tab-cinetique').textContent=lang==='fr'?'âš¡ CINÃ‰TIQUE':'âš¡ KINETICS';
  document.getElementById('tab-arrhenius').textContent=lang==='fr'?'ğŸŒ¡ï¸ ARRHENIUS':'ğŸŒ¡ï¸ ARRHENIUS';
  document.getElementById('tab-theorie').textContent=lang==='fr'?'ğŸ“š THÃ‰ORIE':'ğŸ“š THEORY';
  document.getElementById('tab-rapport').textContent=lang==='fr'?'ğŸ“‹ RAPPORT':'ğŸ“‹ REPORT';
}

// â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•
function showTab(n){
  document.querySelectorAll('.app').forEach(a=>a.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('app-'+n).classList.add('active');
  document.getElementById('tab-'+n).classList.add('active');
  if(n==='arrhenius') drawEnergySVG();
}

// â•â•â•â•â•â•â•â•â•â•â• KINETICS CORE â•â•â•â•â•â•â•â•â•â•â•
function concAtT(t, k, order, c0) {
  if(order===0) return Math.max(0, c0 - k*t);
  if(order===1) return c0 * Math.exp(-k*t);
  if(order===2) return c0 / (1 + k*c0*t);
  return c0;
}
function halfLife(k, order, c0) {
  if(order===0) return c0/(2*k);
  if(order===1) return Math.LN2/k;
  if(order===2) return 1/(k*c0);
}

function runKinetics(){
  const order = parseInt(document.getElementById('orderSel').value);
  const k = parseFloat(document.getElementById('kVal').value);
  const c0 = parseFloat(document.getElementById('c0Val').value);
  const tmax = parseFloat(document.getElementById('tmaxVal').value);
  const rxnType = document.getElementById('rxnType').value;

  kinState = { times:[], concs:[], concsB:[], concsC:[], vels:[], k, order, c0, tmax, running:true, playInterval:null, playIndex:0, computed:true };

  const steps = 200;
  const dt = tmax/steps;
  for(let i=0;i<=steps;i++){
    const t = i*dt;
    const c = concAtT(t,k,order,c0);
    const v = k * Math.pow(Math.max(c,1e-10), order);
    kinState.times.push(t);
    kinState.concs.push(c);
    kinState.vels.push(v);
    // Consecutive
    if(rxnType==='consecutif'){
      const k2=k*0.5;
      const cA=c0*Math.exp(-k*t);
      const cB=rxnType==='consecutif'?c0*(k/(k2-k))*(Math.exp(-k*t)-Math.exp(-k2*t)):0;
      const cC=c0-cA-Math.max(0,cB);
      kinState.concsB.push(Math.max(0,cB));
      kinState.concsC.push(Math.max(0,cC));
    }
  }

  const t12 = halfLife(k,order,c0);
  document.getElementById('disp-t12').textContent = t12.toFixed(1);
  document.getElementById('t12-value').textContent = t12.toFixed(2)+' s';

  // tÂ½ formula
  const fmls = {0:`[A]â‚€/2k = ${(c0/(2*k)).toFixed(2)} s`,1:`ln2/k = ${(Math.LN2/k).toFixed(2)} s`,2:`1/(kÂ·[A]â‚€) = ${(1/(k*c0)).toFixed(2)} s`};
  document.getElementById('t12-formula').textContent = fmls[order];

  // law display
  const laws = {0:'v = k',1:'v = kÂ·[A]',2:'v = kÂ·[A]Â²'};
  document.getElementById('law-display').textContent = laws[order];

  updateDisplayAt(0);
  buildKinCharts(rxnType);
  buildDataTable();
  setStatus('orange','Simulation en cours...');
  setTimeout(()=>setStatus('green',`Simulation terminÃ©e â€” tÂ½ = ${t12.toFixed(2)} s`),500);
}

function buildKinCharts(rxnType){
  // Main concentration chart
  destroyChart('kinChart');
  const ctx=document.getElementById('kinChart').getContext('2d');
  const datasets=[{
    label:'[A](t)',
    data:kinState.concs,
    borderColor:'#ff6b35',backgroundColor:'rgba(255,107,53,0.08)',
    borderWidth:2.5,pointRadius:0,tension:.4,fill:true
  }];
  if(rxnType==='consecutif'){
    datasets.push({label:'[B](t)',data:kinState.concsB,borderColor:'#00d4aa',backgroundColor:'rgba(0,212,170,0.06)',borderWidth:2,pointRadius:0,tension:.4,fill:true});
    datasets.push({label:'[C](t)',data:kinState.concsC,borderColor:'#a78bfa',backgroundColor:'rgba(167,139,250,0.06)',borderWidth:2,pointRadius:0,tension:.4,fill:true});
  }
  charts.kinChart=new Chart(ctx,{type:'line',data:{labels:kinState.times.map(t=>t.toFixed(1)),datasets},options:mkOpts('t (s)','[C] (mol/L)')});

  // Velocity chart
  destroyChart('vChart');
  const ctx2=document.getElementById('vChart').getContext('2d');
  charts.vChart=new Chart(ctx2,{type:'line',data:{labels:kinState.times.map(t=>t.toFixed(1)),datasets:[{label:'v(t)',data:kinState.vels,borderColor:'#fbbf24',backgroundColor:'rgba(251,191,36,0.07)',borderWidth:2,pointRadius:0,tension:.4,fill:true}]},options:mkOpts('t (s)','v (molÂ·Lâ»Â¹Â·sâ»Â¹)')});

  // Linearization chart
  destroyChart('linChart');
  const ctx3=document.getElementById('linChart').getContext('2d');
  const order=kinState.order;
  const linY = kinState.concs.map(c=>{
    if(order===0) return c;
    if(order===1) return Math.log(Math.max(c,1e-15));
    if(order===2) return 1/Math.max(c,1e-10);
  });
  const linLabels={0:'[A]',1:'ln[A]',2:'1/[A]'};
  charts.linChart=new Chart(ctx3,{type:'line',data:{labels:kinState.times.map(t=>t.toFixed(1)),datasets:[{label:linLabels[order]+' = f(t)',data:linY,borderColor:'#38bdf8',backgroundColor:'rgba(56,189,248,0.07)',borderWidth:2,pointRadius:0,tension:0,fill:true}]},options:mkOpts('t (s)',linLabels[order])});
}

function mkOpts(xlabel,ylabel){
  return{
    responsive:true,animation:{duration:200},
    plugins:{legend:{labels:{color:'#4a5080',font:{family:'JetBrains Mono',size:10}}},tooltip:{backgroundColor:'#0d0f1c',titleColor:'#ff6b35',bodyColor:'#e8eaf6'}},
    scales:{
      x:{title:{display:true,text:xlabel,color:'#4a5080'},ticks:{color:'#4a5080',maxTicksLimit:10},grid:{color:'rgba(30,34,69,0.6)'}},
      y:{title:{display:true,text:ylabel,color:'#4a5080'},ticks:{color:'#4a5080'},grid:{color:'rgba(30,34,69,0.6)'}}
    }
  };
}

function destroyChart(id){if(charts[id]){charts[id].destroy();delete charts[id];}}

function buildDataTable(){
  const tbody=document.getElementById('kin-tbody');
  tbody.innerHTML='';
  const step=Math.max(1,Math.floor(kinState.times.length/30));
  for(let i=0;i<kinState.times.length;i+=step){
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${kinState.times[i].toFixed(1)}</td><td>${kinState.concs[i].toFixed(4)}</td><td>${kinState.vels[i].toFixed(5)}</td>`;
    tbody.appendChild(tr);
  }
}

// â•â•â•â•â•â•â•â•â•â•â• PLAYBACK â•â•â•â•â•â•â•â•â•â•â•
function updateDisplayAt(idx){
  const c=kinState.concs[idx]||0;
  const t=kinState.times[idx]||0;
  document.getElementById('disp-ca').textContent=c.toFixed(4);
  document.getElementById('disp-t').textContent=t.toFixed(1);
  const conv=((kinState.c0-c)/kinState.c0*100);
  document.getElementById('disp-conv').textContent=Math.min(99.9,conv).toFixed(1);
  document.getElementById('progress-bar').style.width=Math.min(100,conv)+'%';
  drawMolecules(c/kinState.c0);
}

function togglePlay(){
  if(kinState.playInterval){
    clearInterval(kinState.playInterval);kinState.playInterval=null;
    document.getElementById('btn-play').textContent='â–¶ PLAY';
  } else {
    if(!kinState.computed){alert(lang==='fr'?'Lancez la simulation d\'abord !':'Run simulation first!');return;}
    if(kinState.playIndex>=kinState.times.length-1) kinState.playIndex=0;
    document.getElementById('btn-play').textContent='â¸ PAUSE';
    kinState.playInterval=setInterval(()=>{
      kinState.playIndex+=2;
      if(kinState.playIndex>=kinState.times.length){clearInterval(kinState.playInterval);kinState.playInterval=null;document.getElementById('btn-play').textContent='â–¶ PLAY';return;}
      updateDisplayAt(kinState.playIndex);
    },40);
  }
}
function stepBack(){const di=Math.max(0,kinState.playIndex-10);kinState.playIndex=di;updateDisplayAt(di);}
function stepFwd(){const di=Math.min(kinState.times.length-1,kinState.playIndex+10);kinState.playIndex=di;updateDisplayAt(di);}

// â•â•â•â•â•â•â•â•â•â•â• MOLECULES ANIMATION â•â•â•â•â•â•â•â•â•â•â•
let molAnimFrame=null;
const molState={particles:[],time:0};

function initMolecules(ratio){
  molState.particles=[];
  const n=40;
  for(let i=0;i<n;i++){
    molState.particles.push({
      x:Math.random()*240+10,y:Math.random()*180+10,
      vx:(Math.random()-.5)*2,vy:(Math.random()-.5)*2,
      type:Math.random()<ratio?'A':'P',
      r:Math.random()*2+4
    });
  }
}

function drawMolecules(ratio){
  const canvas=document.getElementById('molCanvas');
  const ctx=canvas.getContext('2d');
  const W=canvas.width,H=canvas.height;
  ctx.clearRect(0,0,W,H);
  ctx.fillStyle='#12152a';ctx.fillRect(0,0,W,H);

  const n=40;
  const nA=Math.round(n*ratio);
  const nP=n-nA;

  // Simple static draw
  const seedA=Math.floor(ratio*100);
  const rng=(s)=>{let x=Math.sin(s)*10000;return x-Math.floor(x);};

  for(let i=0;i<nA;i++){
    const x=rng(i+1)*220+20,y=rng(i+100)*160+20;
    ctx.beginPath();ctx.arc(x,y,5,0,Math.PI*2);
    ctx.fillStyle='rgba(255,107,53,0.85)';ctx.fill();
    ctx.strokeStyle='rgba(255,149,0,0.5)';ctx.lineWidth=1;ctx.stroke();
  }
  for(let i=0;i<nP;i++){
    const x=rng(i+200)*220+20,y=rng(i+300)*160+20;
    ctx.beginPath();ctx.arc(x,y,4,0,Math.PI*2);
    ctx.fillStyle='rgba(0,212,170,0.7)';ctx.fill();
  }

  // Labels
  ctx.fillStyle='rgba(255,107,53,0.8)';ctx.font='11px JetBrains Mono';
  ctx.fillText('â— A  (rÃ©actif)',10,H-30);
  ctx.fillStyle='rgba(0,212,170,0.8)';
  ctx.fillText('â— P  (produit)',10,H-15);

  // Concentration bar
  ctx.fillStyle='rgba(30,34,69,0.8)';ctx.fillRect(W-30,10,18,H-20);
  ctx.fillStyle='rgba(255,107,53,0.7)';
  const barH=(H-20)*ratio;
  ctx.fillRect(W-30,10+(H-20)*(1-ratio),18,barH);
  ctx.fillStyle='#4a5080';ctx.font='9px JetBrains Mono';ctx.fillText('[A]',W-30,8);
}

// â•â•â•â•â•â•â•â•â•â•â• COMPARE ORDERS â•â•â•â•â•â•â•â•â•â•â•
function compareOrders(){
  if(!kinState.computed){alert(lang==='fr'?'Lancez la simulation d\'abord !':'Run simulation first!');return;}
  destroyChart('kinChart');
  const ctx=document.getElementById('kinChart').getContext('2d');
  const k=kinState.k,c0=kinState.c0,tmax=kinState.tmax;
  const steps=200,dt=tmax/steps;
  const times=[],c0s=[],c1s=[],c2s=[];
  for(let i=0;i<=steps;i++){const t=i*dt;times.push(t.toFixed(1));c0s.push(concAtT(t,k,0,c0));c1s.push(concAtT(t,k,1,c0));c2s.push(concAtT(t,k,2,c0));}
  charts.kinChart=new Chart(ctx,{type:'line',data:{labels:times,datasets:[
    {label:'Ordre 0',data:c0s,borderColor:'#38bdf8',backgroundColor:'rgba(56,189,248,0.05)',borderWidth:2,pointRadius:0,tension:0,fill:true},
    {label:'Ordre 1',data:c1s,borderColor:'#00d4aa',backgroundColor:'rgba(0,212,170,0.05)',borderWidth:2,pointRadius:0,tension:.4,fill:true},
    {label:'Ordre 2',data:c2s,borderColor:'#a78bfa',backgroundColor:'rgba(167,139,250,0.05)',borderWidth:2,pointRadius:0,tension:.4,fill:true}
  ]},options:mkOpts('t (s)','[A] (mol/L)')});
}

// â•â•â•â•â•â•â•â•â•â•â• RESET â•â•â•â•â•â•â•â•â•â•â•
function resetKin(){
  kinState={times:[],concs:[],vels:[],k:0.05,order:1,c0:1,tmax:100,running:false,playInterval:null,playIndex:0,computed:false};
  ['kinChart','vChart','linChart'].forEach(destroyChart);
  document.getElementById('kin-tbody').innerHTML='';
  document.getElementById('disp-ca').textContent='1.000';
  document.getElementById('disp-t').textContent='0';
  document.getElementById('disp-t12').textContent='â€”';
  document.getElementById('disp-conv').textContent='0.0';
  document.getElementById('progress-bar').style.width='0%';
  document.getElementById('t12-value').textContent='â€”';
  document.getElementById('t12-formula').textContent='â€”';
  const canvas=document.getElementById('molCanvas');
  const ctx=canvas.getContext('2d');ctx.fillStyle='#12152a';ctx.fillRect(0,0,canvas.width,canvas.height);
  setStatus('red','RÃ©initialisÃ©');
}

function updateRxn(){
  const r=document.getElementById('rxnType').value;
  const rxns={decomp:'A <span class="arrow">â†’</span> Produits',bimol:'A + B <span class="arrow">â†’</span> Produits',reversible:'A <span class="arrow">â‡Œ</span> B',consecutif:'A <span class="arrow">â†’</span> B <span class="arrow">â†’</span> C'};
  document.getElementById('rxn-display').innerHTML=rxns[r];
  document.getElementById('fg-c0b').style.display=r==='bimol'?'block':'none';
}
function updateOrder(){
  const laws={0:'v = k',1:'v = kÂ·[A]',2:'v = kÂ·[A]Â²'};
  document.getElementById('law-display').textContent=laws[document.getElementById('orderSel').value];
}
function updateTempDisplay(v){document.getElementById('temp-disp').textContent=`${v} K (${(v-273).toFixed(0)} Â°C)`;}

// â•â•â•â•â•â•â•â•â•â•â• ARRHENIUS â•â•â•â•â•â•â•â•â•â•â•
function runArrhenius(){
  const A=parseFloat(document.getElementById('arrh-A').value)||1e10;
  const Ea=parseFloat(document.getElementById('arrh-Ea').value)*1000;
  const T1=parseFloat(document.getElementById('arrh-T1').value);
  const T2=parseFloat(document.getElementById('arrh-T2').value);

  const kFn=(T)=>A*Math.exp(-Ea/(R_GAS*T));
  const k298=kFn(298),k350=kFn(350);

  document.getElementById('arrh-k298').textContent=k298.toExponential(3)+' sâ»Â¹';
  document.getElementById('arrh-k350').textContent=k350.toExponential(3)+' sâ»Â¹';
  document.getElementById('arrh-factor').textContent=(k350/k298).toFixed(1)+'Ã—';

  const temps=[],ks=[],invTs=[],lnKs=[];
  for(let T=T1;T<=T2;T+=5){
    const k=kFn(T);
    temps.push(T);ks.push(k);invTs.push((1000/T).toFixed(4));lnKs.push(Math.log(k).toFixed(4));
  }

  const slope=(Math.log(kFn(T2))-Math.log(kFn(T1)))/(1/T2-1/T1);
  document.getElementById('arrh-slope').textContent=slope.toFixed(0)+' K';
  document.getElementById('arrh-ea-calc').textContent=((-slope*R_GAS)/1000).toFixed(1)+' kJ/mol';

  // k=f(T)
  destroyChart('arrhChart');
  const ctx1=document.getElementById('arrhChart').getContext('2d');
  charts.arrhChart=new Chart(ctx1,{type:'line',data:{labels:temps,datasets:[{label:'k = f(T)',data:ks,borderColor:'#ff6b35',backgroundColor:'rgba(255,107,53,0.07)',borderWidth:2,pointRadius:0,tension:.4,fill:true}]},options:mkOpts('T (K)','k (sâ»Â¹)')});

  // Linearization
  destroyChart('arrhLinChart');
  const ctx2=document.getElementById('arrhLinChart').getContext('2d');
  charts.arrhLinChart=new Chart(ctx2,{type:'line',data:{labels:invTs,datasets:[{label:'ln(k) = f(1000/T)',data:lnKs,borderColor:'#a78bfa',backgroundColor:'rgba(167,139,250,0.07)',borderWidth:2,pointRadius:0,tension:0,fill:true}]},options:mkOpts('1000/T (Kâ»Â¹)','ln(k)')});

  drawEnergySVG(Ea/1000);
}

function updateEaSlider(v){
  document.getElementById('ea-disp').textContent=v+' kJ/mol';
  document.getElementById('arrh-Ea').value=v;
  drawEnergySVG(parseFloat(v));
}

function drawEnergySVG(Ea){
  Ea=Ea||parseFloat(document.getElementById('arrh-Ea').value)||50;
  const svg=document.getElementById('energySVG');
  const W=500,H=200;
  const scaleY=H/(Ea*1.8+30);
  const Eproducts=Ea*0.3;

  const pathD=`M 40 ${H-20} Q 130 ${H-20} 180 ${H-20-Ea*scaleY} Q 250 ${H-20-Ea*scaleY-15} 320 ${H-20-Eproducts*scaleY} L 460 ${H-20-Eproducts*scaleY}`;

  svg.innerHTML=`
    <defs>
      <linearGradient id="eGrad" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" style="stop-color:#ff6b35"/>
        <stop offset="50%" style="stop-color:#fbbf24"/>
        <stop offset="100%" style="stop-color:#00d4aa"/>
      </linearGradient>
    </defs>
    <!-- Background -->
    <rect width="${W}" height="${H}" fill="#12152a" rx="6"/>
    <!-- Axes -->
    <line x1="30" y1="10" x2="30" y2="${H-10}" stroke="#1e2245" stroke-width="1"/>
    <line x1="30" y1="${H-20}" x2="${W-20}" y2="${H-20}" stroke="#1e2245" stroke-width="1"/>
    <!-- Labels -->
    <text x="10" y="50" fill="#4a5080" font-family="JetBrains Mono" font-size="9" transform="rotate(-90,10,50)">Ã‰nergie</text>
    <text x="${W/2}" y="${H-4}" fill="#4a5080" font-family="JetBrains Mono" font-size="9" text-anchor="middle">CoordonnÃ©e de rÃ©action</text>
    <!-- Curve -->
    <path d="${pathD}" stroke="url(#eGrad)" stroke-width="3" fill="none"/>
    <!-- Reactants -->
    <line x1="40" y1="${H-20}" x2="140" y2="${H-20}" stroke="#ff6b35" stroke-width="2" stroke-dasharray="4,2"/>
    <text x="90" y="${H-6}" fill="#ff6b35" font-family="JetBrains Mono" font-size="9" text-anchor="middle">RÃ©actifs</text>
    <!-- Products -->
    <line x1="360" y1="${H-20-Eproducts*scaleY}" x2="460" y2="${H-20-Eproducts*scaleY}" stroke="#00d4aa" stroke-width="2" stroke-dasharray="4,2"/>
    <text x="410" y="${H-20-Eproducts*scaleY-6}" fill="#00d4aa" font-family="JetBrains Mono" font-size="9" text-anchor="middle">Produits</text>
    <!-- Transition state -->
    <circle cx="180" cy="${H-20-Ea*scaleY}" r="5" fill="#fbbf24"/>
    <text x="190" y="${H-22-Ea*scaleY}" fill="#fbbf24" font-family="JetBrains Mono" font-size="9">Ã‰tat de transition â€¡</text>
    <!-- Ea arrow -->
    <line x1="90" y1="${H-20}" x2="90" y2="${H-20-Ea*scaleY}" stroke="#fbbf24" stroke-width="1" stroke-dasharray="3,2" marker-end="url(#arr)"/>
    <text x="94" y="${H-20-Ea*scaleY/2}" fill="#fbbf24" font-family="JetBrains Mono" font-size="10">Ea=${Ea.toFixed(0)} kJ</text>
    <!-- Î”H arrow -->
    <line x1="420" y1="${H-20}" x2="420" y2="${H-20-Eproducts*scaleY}" stroke="#38bdf8" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="424" y="${H-20-Eproducts*scaleY/2}" fill="#38bdf8" font-family="JetBrains Mono" font-size="9">Î”H</text>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â• SUIVI EXPÃ‰RIMENTAL â•â•â•â•â•â•â•â•â•â•â•
function showSuivi(type){
  ['spectro','conduc','pressure'].forEach(t=>{
    document.getElementById('suivi-'+t).style.display=t===type?'flex':'none';
    const btn=document.getElementById('s-'+t);
    if(btn){btn.style.background=t===type?'rgba(167,139,250,.2)':'var(--surface2)';btn.style.borderColor=t===type?'var(--p3)':'var(--border)';btn.style.color=t===type?'var(--p3)':'var(--muted)';}
  });
}

function runSuiviSpectro(){
  const k=parseFloat(document.getElementById('sv-k').value);
  const c0=parseFloat(document.getElementById('sv-c0').value);
  const eps=parseFloat(document.getElementById('sv-eps').value);
  const A0=eps*1*c0;
  const times=[],abs=[],lnAbs=[];
  for(let t=0;t<=300;t+=5){
    const c=c0*Math.exp(-k*t);
    const A=eps*1*c;
    times.push(t);abs.push(A.toFixed(4));lnAbs.push(Math.log(A).toFixed(4));
  }
  document.getElementById('sv-abs').textContent=A0.toFixed(3);

  destroyChart('suiviSpectroChart');
  const ctx=document.getElementById('suiviSpectroChart').getContext('2d');
  charts.suiviSpectroChart=new Chart(ctx,{type:'line',data:{labels:times,datasets:[
    {label:'A(t)',data:abs,borderColor:'#a78bfa',backgroundColor:'rgba(167,139,250,0.07)',borderWidth:2,pointRadius:0,tension:.4,yAxisID:'y',fill:true},
    {label:'ln A(t)',data:lnAbs,borderColor:'#fbbf24',backgroundColor:'rgba(251,191,36,0.05)',borderWidth:2,pointRadius:0,tension:0,yAxisID:'y1'}
  ]},options:{responsive:true,plugins:{legend:{labels:{color:'#4a5080',font:{family:'JetBrains Mono',size:10}}}},scales:{x:{ticks:{color:'#4a5080'},grid:{color:'rgba(30,34,69,.6)'},title:{display:true,text:'t (s)',color:'#4a5080'}},y:{ticks:{color:'#a78bfa'},grid:{color:'rgba(30,34,69,.6)'},title:{display:true,text:'A(t)',color:'#a78bfa'},position:'left'},y1:{ticks:{color:'#fbbf24'},grid:{drawOnChartArea:false},title:{display:true,text:'ln A',color:'#fbbf24'},position:'right'}}}});
}

function runSuiviConduc(){
  const k=parseFloat(document.getElementById('cv-k').value);
  const c0=parseFloat(document.getElementById('cv-c0').value);
  const times=[],sigmas=[];
  const type=document.getElementById('cv-rxn').value;
  for(let t=0;t<=600;t+=10){
    const x=c0/(1+k*c0*t);
    let sig;
    if(type==='saponification'){
      sig=Math.max(0.5,(c0-x)*7.2+x*0.8);
    } else {
      sig=2+t/600*1.5;
    }
    times.push(t);sigmas.push(sig.toFixed(4));
  }
  document.getElementById('cv-sig').textContent=sigmas[0];
  destroyChart('suiviCondChart');
  const ctx=document.getElementById('suiviCondChart').getContext('2d');
  charts.suiviCondChart=new Chart(ctx,{type:'line',data:{labels:times,datasets:[{label:'Ïƒ(t) mS/cm',data:sigmas,borderColor:'#00d4aa',backgroundColor:'rgba(0,212,170,0.07)',borderWidth:2,pointRadius:0,tension:.3,fill:true}]},options:mkOpts('t (s)','Ïƒ (mS/cm)')});
}

function runSuiviPression(){
  const k=parseFloat(document.getElementById('pv-k').value);
  const P0=parseFloat(document.getElementById('pv-p0').value);
  const times=[],pressions=[];
  // N2O5 â†’ 2NO2 + 0.5 O2 : 1 mol â†’ 2.5 mol
  for(let t=0;t<=300;t+=5){
    const pA=P0*Math.exp(-k*t);
    const delta=P0-pA;
    const Ptot=pA+2*delta+0.5*delta;
    times.push(t);pressions.push(Ptot.toFixed(4));
  }
  document.getElementById('pv-p').textContent=pressions[0];
  destroyChart('suiviPresChart');
  const ctx=document.getElementById('suiviPresChart').getContext('2d');
  charts.suiviPresChart=new Chart(ctx,{type:'line',data:{labels:times,datasets:[{label:'P_tot(t) (atm)',data:pressions,borderColor:'#ff6b35',backgroundColor:'rgba(255,107,53,0.07)',borderWidth:2,pointRadius:0,tension:.4,fill:true}]},options:mkOpts('t (s)','P (atm)')});
}

// â•â•â•â•â•â•â•â•â•â•â• MÃ‰CANISMES â•â•â•â•â•â•â•â•â•â•â•
const mechs={
  sn1:{
    title:'Substitution NuclÃ©ophile SN1',
    color:'#ff6b35',
    steps:[
      {n:1,title:'Ionisation (Ã©tape lente â€” ECD)',eq:'Râˆ’X â†’ Râº + Xâ»',text:'Formation du carbocation. C\'est l\'Ã©tape lente qui dÃ©termine la loi de vitesse. v = kÂ·[RX]',note:'Ordre 1 global â€” v indÃ©pendant de [Nuâ»]'},
      {n:2,title:'Attaque du nuclÃ©ophile (Ã©tape rapide)',eq:'Râº + Nuâ» â†’ Râˆ’Nu',text:'Le nuclÃ©ophile attaque le carbocation plan des deux cÃ´tÃ©s (mÃ©lange racÃ©mique). TrÃ¨s rapide car Râº est trÃ¨s rÃ©actif.',note:'Pas d\'influence sur la cinÃ©tique globale'},
    ],
    law:'v = kâ‚Â·[Râˆ’X]',
    formula:'Ordre 1 | v = k[RX]'
  },
  sn2:{
    title:'Substitution NuclÃ©ophile SN2',
    color:'#00d4aa',
    steps:[
      {n:1,title:'RÃ©action en une seule Ã©tape concertÃ©e',eq:'Nuâ» + Râˆ’X â†’ [NuÂ·Â·Â·RÂ·Â·Â·X]â€¡ â†’ Nuâˆ’R + Xâ»',text:'Attaque nuclÃ©ophile par derriÃ¨re simultanÃ©ment Ã  la rupture de Râˆ’X. Passage par un Ã©tat de transition Ã  5 groupements.',note:'Inversion de Walden (configuration inversÃ©e)'},
    ],
    law:'v = kâ‚‚Â·[Nuâ»]Â·[Râˆ’X]',
    formula:'Ordre 2 global | v = k[Nuâ»][RX]'
  },
  radical:{
    title:'RÃ©action en ChaÃ®ne Radicalaire (HalogÃ©nation)',
    color:'#a78bfa',
    steps:[
      {n:1,title:'Initiation (lente)',eq:'Clâ‚‚ + hÎ½ â†’ 2 Clâ€¢',text:'La lumiÃ¨re fournit l\'Ã©nergie pour rompre homolytiquement le lien Clâˆ’Cl. Formation des radicaux initiateurs.',note:'k_init trÃ¨s faible'},
      {n:2,title:'Propagation 1',eq:'Clâ€¢ + CHâ‚„ â†’ HCl + CHâ‚ƒâ€¢',text:'Le radical chlore arrache un hydrogÃ¨ne. Formation du radical mÃ©thyle.',note:'Ã‰tape rapide'},
      {n:3,title:'Propagation 2',eq:'CHâ‚ƒâ€¢ + Clâ‚‚ â†’ CHâ‚ƒCl + Clâ€¢',text:'RÃ©gÃ©nÃ©ration du radical Clâ€¢. La chaÃ®ne se perpÃ©tue (10Â³â€“10â¶ cycles).',note:'TrÃ¨s rapide'},
      {n:4,title:'Terminaison',eq:'2 Clâ€¢ â†’ Clâ‚‚ | Clâ€¢ + CHâ‚ƒâ€¢ â†’ CHâ‚ƒCl',text:'Recombinaison des radicaux. Met fin Ã  la chaÃ®ne.',note:'Longueur de chaÃ®ne = v_prop / v_term'},
    ],
    law:'v âˆ [RH]Â·[Clâ‚‚]^(1/2)',
    formula:'Ordre 3/2 apparent â€” AEQS sur Clâ€¢'
  },
  michaelis:{
    title:'CinÃ©tique Enzymatique â€” Michaelis-Menten',
    color:'#fbbf24',
    steps:[
      {n:1,title:'Formation du complexe enzyme-substrat',eq:'E + S â‡Œ ES  (kâ‚, kâ‚‹â‚)',text:'L\'enzyme (E) se lie au substrat (S) de maniÃ¨re rÃ©versible. Formation du complexe ES. AEQS : d[ES]/dt â‰ˆ 0.',note:'Km = (kâ‚‹â‚+kâ‚‚)/kâ‚ (constante de Michaelis)'},
      {n:2,title:'Transformation catalytique',eq:'ES â†’ E + P  (kâ‚‚)',text:'Le complexe ES se transforme en produit P avec rÃ©gÃ©nÃ©ration de l\'enzyme. C\'est l\'Ã©tape catalytique.',note:'vmax = kâ‚‚Â·[E]tot'},
    ],
    law:'v = vmaxÂ·[S]/(Km + [S])',
    formula:'Equation de Michaelis-Menten'
  },
  consecutif:{
    title:'RÃ©actions ConsÃ©cutives A â†’ B â†’ C',
    color:'#38bdf8',
    steps:[
      {n:1,title:'Disparition de A (ordre 1)',eq:'d[A]/dt = âˆ’kâ‚Â·[A]   â†’   [A] = [A]â‚€Â·e^(âˆ’kâ‚t)',text:'Le rÃ©actif A disparaÃ®t exponentiellement avec la constante de vitesse kâ‚.',note:'[A] dÃ©croÃ®t toujours'},
      {n:2,title:'Ã‰volution de l\'intermÃ©diaire B',eq:'d[B]/dt = kâ‚[A] âˆ’ kâ‚‚[B]',text:'B est formÃ© par A (terme +kâ‚[A]) et consommÃ© vers C (terme âˆ’kâ‚‚[B]). Il passe par un maximum.',note:`t_max = ln(kâ‚‚/kâ‚)/(kâ‚‚âˆ’kâ‚)`},
      {n:3,title:'Formation de C (produit final)',eq:'[C] = [A]â‚€ âˆ’ [A] âˆ’ [B]',text:'C s\'accumule progressivement. Ã€ tâ†’âˆ, [C] = [A]â‚€ (conversion totale).',note:'AEQS si kâ‚‚ â‰« kâ‚ â†’ v â‰ˆ kâ‚[A]'},
    ],
    law:'[B]max atteint Ã  t_max = ln(kâ‚‚/kâ‚)/(kâ‚‚âˆ’kâ‚)',
    formula:'RÃ©action consÃ©cutive â€” IntermÃ©diaire B'
  }
};

function showMech(type){
  document.querySelectorAll('.mech-btn').forEach(b=>{b.style.background='var(--surface2)';b.style.borderColor='var(--border)';b.style.color='var(--muted)';});
  event.target.style.background=`rgba(255,107,53,.15)`;event.target.style.borderColor='var(--p1)';event.target.style.color='var(--p1)';

  const m=mechs[type];
  let html=`<div style="margin-bottom:16px;">
    <div style="font-family:'Syne',sans-serif;font-size:1.1rem;font-weight:700;color:${m.color};margin-bottom:6px;">${m.title}</div>
    <div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:10px 16px;font-family:'JetBrains Mono',monospace;font-size:.82rem;color:var(--p2);display:flex;gap:20px;flex-wrap:wrap;">
      <span>LOI DE VITESSE : <span style="color:${m.color}">${m.law}</span></span>
      <span>â†’ ${m.formula}</span>
    </div>
  </div>`;
  m.steps.forEach(s=>{
    html+=`<div class="mech-step">
      <div class="mech-num" style="background:${m.color}">${s.n}</div>
      <div>
        <div style="font-family:'Syne',sans-serif;font-weight:600;color:${m.color};margin-bottom:4px;">${s.title}</div>
        <div class="eq">${s.eq}</div>
        <div style="font-size:.81rem;color:#8a9cc0;margin-top:6px;line-height:1.6;">${s.text}</div>
        <div style="margin-top:6px;background:rgba(255,107,53,.08);border-radius:4px;padding:4px 8px;font-size:.74rem;font-family:'JetBrains Mono',monospace;color:${m.color};">âš¡ ${s.note}</div>
      </div>
    </div>`;
  });
  document.getElementById('mech-content').innerHTML=html;
}

// â•â•â•â•â•â•â•â•â•â•â• EXPORT â•â•â•â•â•â•â•â•â•â•â•
function exportKinCSV(){
  let csv='t (s),[A] (mol/L),v (mol/L/s)\n';
  kinState.times.forEach((t,i)=>{csv+=`${t.toFixed(2)},${kinState.concs[i].toFixed(5)},${kinState.vels[i].toFixed(6)}\n`;});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));
  a.download='cinetique_TCHOKPON.csv';a.click();
}

// â•â•â•â•â•â•â•â•â•â•â• REPORT â•â•â•â•â•â•â•â•â•â•â•
function generateReport(){
  const box=document.getElementById('rpt-content');
  if(!kinState.computed){box.innerHTML='<div style="text-align:center;color:var(--muted);padding:40px;">âš¡ Effectuez une simulation cinÃ©tique d\'abord.</div>';return;}
  const orderNames={0:'ZÃ©ro (0)',1:'Premier (1)',2:'Second (2)'};
  const t12=halfLife(kinState.k,kinState.order,kinState.c0);
  const t=document.getElementById('tempVal').value;
  const laws={0:'[A] = [A]â‚€ âˆ’ kÂ·t',1:'[A] = [A]â‚€Â·exp(âˆ’kÂ·t)',2:'1/[A] = 1/[A]â‚€ + kÂ·t'};
  const lins={0:'[A] = f(t) â†’ linÃ©aire, pente = âˆ’k',1:'ln[A] = f(t) â†’ linÃ©aire, pente = âˆ’k',2:'1/[A] = f(t) â†’ linÃ©aire, pente = +k'};
  const date=new Date().toLocaleDateString('fr-FR');
  box.innerHTML=`
  <div class="rpt-sec"><h4>â”â”â” RAPPORT DE TP â€” CINÃ‰TIQUE CHIMIQUE â”â”â”</h4>
  <p>Auteur : <span class="hl">Edmond Atinzoun TCHOKPON</span></p>
  <p>Licence Physique-Chimie | Date : <span class="hl">${date}</span></p></div>
  <div class="rpt-sec"><h4>1. RÃ‰ACTION SIMULÃ‰E</h4>
  <p>Type : ${document.getElementById('rxnType').options[document.getElementById('rxnType').selectedIndex].text}</p>
  <p>Ordre de rÃ©action : <span class="hl">${orderNames[kinState.order]}</span></p>
  <p>Loi de vitesse : <span class="hl2">${laws[kinState.order]}</span></p></div>
  <div class="rpt-sec"><h4>2. PARAMÃˆTRES EXPÃ‰RIMENTAUX</h4>
  <p>Constante de vitesse k = <span class="hl">${kinState.k} sâ»Â¹ (ou LÂ·molâ»Â¹Â·sâ»Â¹)</span></p>
  <p>Concentration initiale [A]â‚€ = <span class="hl">${kinState.c0} mol/L</span></p>
  <p>TempÃ©rature = <span class="hl">${t} K (${(t-273).toFixed(0)} Â°C)</span></p>
  <p>DurÃ©e de simulation = <span class="hl">${kinState.tmax} s</span> | Points calculÃ©s : <span class="hl">${kinState.times.length}</span></p></div>
  <div class="rpt-sec"><h4>3. RÃ‰SULTATS</h4>
  <p>Demi-vie tÂ½ = <span class="hl2">${t12.toFixed(3)} s</span></p>
  <p>Concentration finale [A](${kinState.tmax}s) = <span class="hl">${kinState.concs[kinState.concs.length-1].toFixed(5)} mol/L</span></p>
  <p>Taux de conversion final = <span class="hl2">${((1-kinState.concs[kinState.concs.length-1]/kinState.c0)*100).toFixed(1)} %</span></p></div>
  <div class="rpt-sec"><h4>4. MÃ‰THODE DE DÃ‰TERMINATION DE L'ORDRE</h4>
  <p>LinÃ©arisation : <span class="hl">${lins[kinState.order]}</span></p>
  <p>La droite obtenue confirme l'ordre ${kinState.order} avec une pente = ${kinState.order===2?'+':'-'}k = ${kinState.order===2?'+':'-'}${kinState.k}</p></div>
  <div class="rpt-sec"><h4>5. CONCLUSION</h4>
  <p>La rÃ©action est d'ordre <span class="hl">${kinState.order}</span>. La constante de vitesse k = ${kinState.k} sâ»Â¹ Ã  ${t} K.
  La demi-vie tÂ½ = ${t12.toFixed(2)} s ${kinState.order===1?'est indÃ©pendante de [A]â‚€ (propriÃ©tÃ© de l\'ordre 1)':''}.
  La linÃ©arisation des donnÃ©es expÃ©rimentales confirme l'ordre par la droite obtenue.</p></div>
  <div style="margin-top:16px;text-align:center;color:var(--muted);font-size:.68rem;">â”€â”€ SimuKin v1.0 | Edmond Atinzoun TCHOKPON | Licence Physique-Chimie â”€â”€</div>`;
}

// â•â•â•â•â•â•â•â•â•â•â• UTILS â•â•â•â•â•â•â•â•â•â•â•
function setStatus(type,msg){
  const dot=document.getElementById('sdot');
  const colors={green:'',orange:'orange',red:'red'};
  dot.className='sdot '+(colors[type]||'');
  document.getElementById('stext').textContent=msg;
}

// Clock
setInterval(()=>{document.getElementById('sclock').textContent=new Date().toLocaleTimeString('fr-FR');},1000);

// Init
updateRxn();
drawMolecules(1);
showMech('sn1');
drawEnergySVG(50);
</script>
<<script src="https://pl28749769.effectivegatecpm.com/7e/50/ae/7e50ae4d2dc2865da45f931b5ab38c5b.js"></script>
/body>
</html>
